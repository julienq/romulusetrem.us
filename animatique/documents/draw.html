<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Draw!</title>
    <meta charset="UTF-8">
    <style>
      body { font-family: "Helvetica Neue", Helvetica, sans-serif;
        background-color: #444 }
      #canvas { width: 768px; height: 480px; background-color: white; }
    </style>
    <script src="flexo.js"></script>
    <script src="draw.js"></script>
  </head>
  <body>
    <div id="canvas"></div>
    <script>

      var draw = Object.create(svg_draw).init(document.getElementById("canvas"));
      document.addEventListener("keydown", function(e) {
          if (!e.altKey && !e.ctrlKey && !e.metaKey && !e.shiftKey) {
            e.preventDefault();
            var which = e.keyCode || e.which;
            if (e.keyCode === 82) {
              // r redo
              draw.redo();
            } else if (e.keyCode === 83) {
              // s save
              var req = new XMLHttpRequest();
              req.open("POST", "/save/" + flexo.random_id(6) + ".svg");
              req.setRequestHeader("Content-type", "image/svg+xml");
              var src = draw.svg.parentNode.innerHTML.replace(/<svg /,
                "<svg xmlns=\"{0}\" ".fmt(flexo.SVG_NS));
              req.send(src);
            } else if (e.keyCode === 85) {
              // u undo
              draw.undo();
            }
          }
        }, false);

    </script>
  </body>
</html>

